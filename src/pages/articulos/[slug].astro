---
import Layout from '../../layouts/Layout.astro';
import Footer from '../../components/Footer.astro';
import { getCollection } from 'astro:content';

export const prerender = true;

export async function getStaticPaths() {
  const blogs = await getCollection('blogs');

  return blogs.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;

const { title, metadescription, date, updated, author, tags, category, cover, coveralt, canonical, sources = [] } = entry.data;

const { Content } = await entry.render();

const preloads = [
	  {
    href: "/fonts/SpaceGrotesk-600.woff2",
    as: "font",
    type: "font/woff2",
    crossorigin: "anonymous",
  },
];

---

<Layout title={title} preloads={preloads} robots="index,follow" canonical={canonical} description={metadescription}>


  <div class="relative bg-brand-dark overflow-hidden">

    <div class="flex flex-col mx-auto max-w-2xl mb-8 px-4 md:px-0">

      <a class="flex pt-8 text-brand-white items-center gap-2 cursor-pointer" href="/">
        <i class="icon-[material-symbols--arrow-back]" aria-hidden="true"></i>
        <span class="underline">Volver a la p√°gina principal</span>
      </a>

    </div>
    
		<main class="mx-auto bg-brand-white/10 max-w-3xl px-4 md:px-0">

      <article class="text-brand-white mb-8 py-4 px-4 md:px-12">
        <img src={cover} alt={coveralt} />
        <p class="flex justify-center text-h3">{author}</p>
        <time class="flex justify-center">
          {
            date.toLocaleDateString("es-ES", {
              day: "numeric",
              month: "long",
              year: "numeric",
            })
          }
        </time>

        <Content />
      </article>

      <aside class="px-4 md:px-12 pb-12 mb-6">
        <h3 class="text-h3 mb-6">Fuentes:</h3>
        <ol class="flex flex-col gap-y-4">
          {
            sources.map((source) => {
              return (
                <li class="flex gap-x-4">
                  <p>{source.index}</p>
                  <a class="underline" href={source.url}>{source.label}</a>
                </li>
              )
            })
          }
        </ol>
        
      </aside>
    </main>
  
  </div>

  <Footer />
</Layout>
